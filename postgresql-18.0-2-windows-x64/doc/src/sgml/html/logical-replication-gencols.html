<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>29.6. Generated Column Replication</title><link rel="stylesheet" type="text/css" href="stylesheet.css" /><link rev="made" href="pgsql-docs@lists.postgresql.org" /><meta name="generator" content="DocBook XSL Stylesheets Vsnapshot" /><link rel="prev" href="logical-replication-col-lists.html" title="29.5. Column Lists" /><link rel="next" href="logical-replication-conflicts.html" title="29.7. Conflicts" /></head><body id="docContent" class="container-fluid col-10"><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="5" align="center">29.6. Generated Column Replication</th></tr><tr><td width="10%" align="left"><a accesskey="p" href="logical-replication-col-lists.html" title="29.5. Column Lists">Prev</a> </td><td width="10%" align="left"><a accesskey="u" href="logical-replication.html" title="Chapter 29. Logical Replication">Up</a></td><th width="60%" align="center">Chapter 29. Logical Replication</th><td width="10%" align="right"><a accesskey="h" href="index.html" title="PostgreSQL 18.0 Documentation">Home</a></td><td width="10%" align="right"> <a accesskey="n" href="logical-replication-conflicts.html" title="29.7. Conflicts">Next</a></td></tr></table><hr /></div><div class="sect1" id="LOGICAL-REPLICATION-GENCOLS"><div class="titlepage"><div><div><h2 class="title" style="clear: both">29.6. Generated Column Replication <a href="#LOGICAL-REPLICATION-GENCOLS" class="id_link">#</a></h2></div></div></div><p>
   Typically, a table at the subscriber will be defined the same as the
   publisher table, so if the publisher table has a <a class="link" href="ddl-generated-columns.html" title="5.4. Generated Columns">
   <code class="literal">GENERATED column</code></a> then the subscriber table will
   have a matching generated column. In this case, it is always the subscriber
   table generated column value that is used.
  </p><p>
   For example, note below that subscriber table generated column value comes from the
   subscriber column's calculation.
</p><pre class="programlisting">
/* pub # */ CREATE TABLE tab_gen_to_gen (a int, b int GENERATED ALWAYS AS (a + 1) STORED);
/* pub # */ INSERT INTO tab_gen_to_gen VALUES (1),(2),(3);
/* pub # */ CREATE PUBLICATION pub1 FOR TABLE tab_gen_to_gen;
/* pub # */ SELECT * FROM tab_gen_to_gen;
 a | b
---+---
 1 | 2
 2 | 3
 3 | 4
(3 rows)

/* sub # */ CREATE TABLE tab_gen_to_gen (a int, b int GENERATED ALWAYS AS (a * 100) STORED);
/* sub # */ CREATE SUBSCRIPTION sub1 CONNECTION 'dbname=test_pub' PUBLICATION pub1;
/* sub # */ SELECT * from tab_gen_to_gen;
 a | b
---+----
 1 | 100
 2 | 200
 3 | 300
(3 rows)
</pre><p>
  </p><p>
   In fact, prior to version 18.0, logical replication does not publish
   <code class="literal">GENERATED</code> columns at all.
  </p><p>
   But, replicating a generated column to a regular column can sometimes be
   desirable.
   </p><div class="tip"><h3 class="title">Tip</h3><p>
     This feature may be useful when replicating data to a
     non-PostgreSQL database via output plugin, especially if the target database
     does not support generated columns.
    </p></div><p>
  </p><p>
   Generated columns are not published by default, but users can opt to
   publish stored generated columns just like regular ones.
  </p><p>
   There are two ways to do this:
   </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
       Set the <code class="command">PUBLICATION</code> parameter
       <a class="link" href="sql-createpublication.html#SQL-CREATEPUBLICATION-PARAMS-WITH-PUBLISH-GENERATED-COLUMNS">
       <code class="literal">publish_generated_columns</code></a> to <code class="literal">stored</code>.
       This instructs PostgreSQL logical replication to publish current and
       future stored generated columns of the publication's tables.
      </p></li><li class="listitem"><p>
       Specify a table <a class="link" href="logical-replication-col-lists.html" title="29.5. Column Lists">column list</a>
       to explicitly nominate which stored generated columns will be published.
      </p><div class="note"><h3 class="title">Note</h3><p>
        When determining which table columns will be published, a column list
        takes precedence, overriding the effect of the
        <code class="literal">publish_generated_columns</code> parameter.
       </p></div></li></ul></div><p>
  </p><p>
   The following table summarizes behavior when there are generated columns
   involved in the logical replication. Results are shown for when
   publishing generated columns is not enabled, and for when it is
   enabled.
  </p><div class="table" id="LOGICAL-REPLICATION-GENCOLS-TABLE-SUMMARY"><p class="title"><strong>Table 29.2. Replication Result Summary</strong></p><div class="table-contents"><table class="table" summary="Replication Result Summary" border="1"><colgroup><col /><col /><col /><col /></colgroup><thead><tr><th>Publish generated columns?</th><th>Publisher table column</th><th>Subscriber table column</th><th>Result</th></tr></thead><tbody><tr><td>No</td><td>GENERATED</td><td>GENERATED</td><td>Publisher table column is not replicated. Use the subscriber table generated column value.</td></tr><tr><td>No</td><td>GENERATED</td><td>regular</td><td>Publisher table column is not replicated. Use the subscriber table regular column default value.</td></tr><tr><td>No</td><td>GENERATED</td><td>--missing--</td><td>Publisher table column is not replicated. Nothing happens.</td></tr><tr><td>Yes</td><td>GENERATED</td><td>GENERATED</td><td>ERROR. Not supported.</td></tr><tr><td>Yes</td><td>GENERATED</td><td>regular</td><td>Publisher table column value is replicated to the subscriber table column.</td></tr><tr><td>Yes</td><td>GENERATED</td><td>--missing--</td><td>ERROR. The column is reported as missing from the subscriber table.</td></tr></tbody></table></div></div><br class="table-break" /><div class="warning"><h3 class="title">Warning</h3><p>
    There's currently no support for subscriptions comprising several
    publications where the same table has been published with different column
    lists. See <a class="xref" href="logical-replication-col-lists.html" title="29.5. Column Lists">Section 29.5</a>.
   </p><p>
    This same situation can occur if one publication is publishing generated
    columns, while another publication in the same subscription is not
    publishing generated columns for the same table.
   </p></div><div class="note"><h3 class="title">Note</h3><p>
    If the subscriber is from a release prior to 18, then initial table
    synchronization won't copy generated columns even if they are defined in
    the publisher.
   </p></div></div><div class="navfooter"><hr /><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="logical-replication-col-lists.html" title="29.5. Column Lists">Prev</a> </td><td width="20%" align="center"><a accesskey="u" href="logical-replication.html" title="Chapter 29. Logical Replication">Up</a></td><td width="40%" align="right"> <a accesskey="n" href="logical-replication-conflicts.html" title="29.7. Conflicts">Next</a></td></tr><tr><td width="40%" align="left" valign="top">29.5. Column Lists </td><td width="20%" align="center"><a accesskey="h" href="index.html" title="PostgreSQL 18.0 Documentation">Home</a></td><td width="40%" align="right" valign="top"> 29.7. Conflicts</td></tr></table></div></body></html>